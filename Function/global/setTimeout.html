<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>setTimeout</title>
</head>
<body>
<script>
  for (var i=0; i<5; i++) {
    setTimeout('console.log(i)', 1000);
  }

  //（1）引入IIFE
  for(var i = 0;i<5;i ++) {
    (function(i){
      setTimeout(function timer() {
        console.log(i)
      }, i * 1000);
    })(i);
  }

  //（2）利用ES6引入的let关键字
  for(let i=0;i<5;i++) {
    setTimeout(function timer(){
      console.log(i);
    }, i * 1000);
  }

  // for 循环头部的let 声明还会有一个特殊的行为。这个行为指出变量在循环过程中不止被声明一次，每次迭代都会声明。
  // 随后的每个迭代都会使用上一个迭代结束时的值来初始化这个变量。

  //（3）利用ES5引入的bind函数
  for (var i=1; i<=5; i++) {
    setTimeout( function timer(i) {
      console.log(i);
    }.bind(null,i), i*1000 );
  }

  //（4）利用setTimeout第三个参数
  for (var i=1; i<=5; i++) {
    setTimeout( function timer(i) {
      console.log(i);
    }, i*1000,i );
  }
  // 注：setTimeout函数第三个参数及以后的参数都可以作为timer函数的参数。

  //（5）把setTimeout用一个方法单独出来形成闭包
  var loop = function (i) {
    setTimeout(function timer() {
      console.log(i);
    }, i*1000);
  };
  for (var i = 1;i <= 5; i++) {
    loop(i);
  }
</script>
</body>
</html>
